<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados Lotof√°cil - An√°lise Inteligente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#672666',
                        'primary-light': '#823081',
                        'primary-dark': '#5d225c',
                        'light-bg': '#f8ecf8',
                        'dark-bg': '#250e25',
                        'custom-100': '#ffffff',
                        'custom-95': '#f8ecf8',
                        'custom-90': '#f1daf1',
                        'custom-85': '#eac7ea',
                        'custom-80': '#e3b5e3',
                        'custom-75': '#dda2dc',
                        'custom-70': '#d68fd5',
                        'custom-65': '#cf7dcd',
                        'custom-60': '#c86ac6',
                        'custom-55': '#c157bf',
                        'custom-50': '#ba45b8',
                        'custom-45': '#a83ea6',
                        'custom-40': '#953793',
                        'custom-35': '#823081',
                        'custom-30': '#70296f',
                        'custom-28': '#672666',
                        'custom-25': '#5d225c',
                        'custom-20': '#4a1c4a',
                        'custom-15': '#381537',
                        'custom-10': '#250e25',
                        'custom-5': '#130712',
                        'custom-0': '#000000'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }
        .loading-circle {
            width: 100px;
            height: 100px;
            background-image: linear-gradient(#f8ecf8, #672666, #381537);
            border-radius: 50%;
            animation: pulse 3s infinite;
        }
        
        .numero-par {
            background-color: #eac7ea;
            color: #381537;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .numero-impar {
            background-color: #c157bf;
            color: #130712;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .dark .numero-par {
            background-color: #381537;
            color: #eac7ea;
        }
        
        .dark .numero-impar {
            background-color: #5d225c;
            color: #f1daf1;
        }

        .numero-eliminado {
            background-color: #fca5a5;
            color: #7f1d1d;
            border: 2px solid #ef4444;
        }

        .dark .numero-eliminado {
            background-color: #7f1d1d;
            color: #fca5a5;
            border: 2px solid #dc2626;
        }

        .numero-disponivel {
            background-color: #c157bf;
            color: #130712;
            border: 2px solid #672666;
        }

        .dark .numero-disponivel {
            background-color: #381537;
            color: #c157bf;
            border: 2px solid #5d225c;
        }

        .numero-palpite {
            background-color: #60a5fa;
            color: #1e3a8a;
            border: 2px solid #3b82f6;
            font-weight: bold;
        }

        .dark .numero-palpite {
            background-color: #1e3a8a;
            color: #60a5fa;
            border: 2px solid #2563eb;
        }

        .numero-sorteado {
            background-color: #ef4444;
            color: white;
            border: 2px solid #fbbf24;
            position: relative;
        }

        .numero-sorteado::after {
            content: "üéØ";
            position: absolute;
            top: -8px;
            right: -8px;
            font-size: 10px;
        }

        .numero-sorteado.disabled {
            background-color: #6b7280;
            opacity: 0.4;
            cursor: not-allowed;
        }

        .dark .numero-sorteado {
            background-color: #dc2626;
            color: white;
        }

        .dark .numero-sorteado.disabled {
            background-color: #4b5563;
            opacity: 0.4;
        }
        
        .filtro-ativo {
            background-color: #672666;
            color: white;
        }

        .numero-frequente {
            background-color: #10b981;
            color: white;
            border: 2px solid #059669;
        }

        .numero-raro {
            background-color: #f59e0b;
            color: white;
            border: 2px solid #d97706;
        }

        .numero-medio {
            background-color: #6366f1;
            color: white;
            border: 2px solid #4f46e5;
        }
    </style>
</head>
<body class="bg-light-bg dark:bg-dark-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">
                üå∏ Resultados Lotof√°cil - AN√ÅLISE INTELIGENTE
            </h1>
            <p class="text-gray-600 dark:text-gray-300">
                Dados oficiais da Caixa Econ√¥mica Federal com estrat√©gias baseadas em estat√≠sticas reais
            </p>
        </div>

        <!-- Controles -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col gap-4">
                <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
                    <div class="flex flex-col sm:flex-row gap-4 items-center">
                        <label class="text-gray-700 dark:text-gray-300 font-medium">
                            Concursos:
                        </label>
                        <input 
                            type="number" 
                            id="concursoInicio" 
                            value="1"
                            placeholder="Concurso inicial"
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                        <span class="text-gray-500 dark:text-gray-400">at√©</span>
                        <input 
                            type="number" 
                            id="concursoFim" 
                            placeholder="Buscando √∫ltimo..."
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                    </div>
                    <button 
                        id="buscarBtn" 
                        class="bg-primary hover:bg-primary-dark text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50"
                    >
                        üîç Carregar TODOS os Resultados
                    </button>
                </div>
                
                <!-- Op√ß√µes de destacar e ordena√ß√£o -->
                <div class="flex flex-col sm:flex-row gap-4 items-center">
                    <label class="text-gray-700 dark:text-gray-300 font-medium">
                        Destacar:
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarPares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">Pares</span>
                        <div class="w-4 h-4 ml-2 rounded border" style="background-color: #eac7ea;"></div>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarImpares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">√çmpares</span>
                        <div class="w-4 h-4 ml-2 rounded border" style="background-color: #c157bf;"></div>
                    </label>
                    
                    <!-- Divisor -->
                    <div class="hidden sm:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarCrescente" class="mr-2">
                        <span class="text-gray-700 dark:text-gray-300">üìä Ordenar dezenas crescente</span>
                    </label>
                    
                    <!-- Divisor -->
                    <div class="hidden sm:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarConcursoDecrescente" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">üî¢ Concursos em ordem decrescente</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p id="loadingText" class="text-gray-600 dark:text-gray-300 mb-4">
                Carregando dados da API da Caixa Econ√¥mica Federal...
            </p>
            
            <!-- Barra de progresso -->
            <div class="max-w-md mx-auto">
                <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2">
                    <div id="progressBar" class="bg-primary h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                    <span id="progressText">0 / 0 concursos</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>
            
            <!-- Bot√£o cancelar -->
            <button id="cancelarBtn" class="mt-4 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition-colors">
                ‚ùå Cancelar Carregamento
            </button>
        </div>

        <!-- Erro -->
        <div id="erro" class="hidden bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg mb-6">
            <span id="erroMsg"></span>
        </div>

        <!-- Status da API -->
        <div id="statusApi" class="hidden mb-4 p-4 rounded-lg border">
            <div class="flex items-center justify-between">
                <div>
                    <h3 class="font-semibold text-sm">üåê Status da API da Caixa</h3>
                    <p id="statusTexto" class="text-xs mt-1"></p>
                </div>
                <div id="ultimoConcursoInfo" class="text-right">
                    <div class="text-sm font-bold">√öltimo Concurso: <span id="numeroUltimoConcurso">-</span></div>
                    <div class="text-xs" id="dataUltimoConcurso">-</div>
                </div>
            </div>
        </div>

        <!-- Bot√£o Toggle Tabela -->
        <div id="toggleTabelaContainer" class="hidden mb-4 text-center">
            <button 
                id="toggleTabelaBtn" 
                class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200"
            >
                üëÅÔ∏è Ocultar Tabela de Resultados
            </button>
        </div>

        <!-- Tabela de Resultados -->
        <div id="resultados" class="hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
                <div class="text-white p-4" style="background: linear-gradient(to right, #672666, #823081);">
                    <h2 class="text-xl font-bold text-center">LOTOF√ÅCIL - DADOS OFICIAIS DA CAIXA</h2>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Concurso
                                </th>
                                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Data Sorteio
                                </th>
                                <!-- 15 colunas para os n√∫meros -->
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">1¬∫</span>
                                        <input type="text" id="filtro1" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">2¬∫</span>
                                        <input type="text" id="filtro2" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">3¬∫</span>
                                        <input type="text" id="filtro3" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">4¬∫</span>
                                        <input type="text" id="filtro4" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">5¬∫</span>
                                        <input type="text" id="filtro5" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">6¬∫</span>
                                        <input type="text" id="filtro6" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">7¬∫</span>
                                        <input type="text" id="filtro7" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">8¬∫</span>
                                        <input type="text" id="filtro8" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">9¬∫</span>
                                        <input type="text" id="filtro9" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">10¬∫</span>
                                        <input type="text" id="filtro10" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">11¬∫</span>
                                        <input type="text" id="filtro11" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">12¬∫</span>
                                        <input type="text" id="filtro12" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">13¬∫</span>
                                        <input type="text" id="filtro13" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">14¬∫</span>
                                        <input type="text" id="filtro14" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">15¬∫</span>
                                        <input type="text" id="filtro15" placeholder="F" class="mt-1 px-1 py-1 text-xs border rounded w-8">
                                    </div>
                                </th>
                                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Estat√≠stica P/I
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tabelaBody" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                            <!-- Resultados ser√£o inseridos aqui -->
                        </tbody>
                    </table>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3">
                    <div class="flex flex-col sm:flex-row justify-between items-center">
                        <p class="text-sm text-gray-600 dark:text-gray-300">
                            üìä Fonte: API Oficial da Caixa Econ√¥mica Federal
                        </p>
                        <p id="contadorResultados" class="text-sm font-medium text-primary-dark dark:text-primary-light">
                            <!-- Contador ser√° inserido aqui -->
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resumo Estat√≠stico -->
        <div id="resumoEstatistico" class="hidden mt-8 rounded-lg p-6" style="background: linear-gradient(to right, #f8ecf8, #f1daf1); border: 1px solid #cf7dcd;">
            <h3 class="text-xl font-bold mb-6 text-center" style="color: #381537;">
                üìä An√°lise Estat√≠stica Baseada em Dados Reais
            </h3>
            <div id="estatisticasGerais" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Estat√≠sticas ser√£o inseridas aqui -->
            </div>
            
            <!-- Frequ√™ncia dos N√∫meros -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ Frequ√™ncia dos N√∫meros (√öltimos 50 Concursos)
                </h4>
                <div id="frequenciaNumerosGrid" class="grid grid-cols-5 gap-2">
                    <!-- Grid de frequ√™ncia ser√° inserido aqui -->
                </div>
            </div>
            
            <!-- Gr√°fico visual simples -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ Distribui√ß√£o de Padr√µes Par/√çmpar
                </h4>
                <div id="graficoBarras" class="space-y-3">
                    <!-- Gr√°fico de barras ser√° inserido aqui -->
                </div>
            </div>
            
            <!-- Padr√µes encontrados -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üîç Insights Baseados em Dados Reais
                </h4>
                <div id="padroes" class="text-sm text-gray-700 dark:text-gray-300">
                    <!-- Padr√µes ser√£o inseridos aqui -->
                </div>
            </div>
        </div>

        <!-- Gerador de Palpites -->
        <div id="geradorPalpites" class="hidden mt-8 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900 dark:to-indigo-900 border border-purple-200 dark:border-purple-700 rounded-lg p-6">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-purple-800 dark:text-purple-200 mb-2">
                    üå∏ Gerador de Palpites Inteligente
                </h3>
                <p class="text-purple-600 dark:text-purple-300 text-sm">
                    Estrat√©gias baseadas em an√°lise estat√≠stica de dados oficiais da Caixa
                </p>
                <button 
                    id="comoFuncionaBtn" 
                    class="mt-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white text-sm rounded-lg transition-colors"
                >
                    ‚ùì Como Funciona?
                </button>
            </div>

            <!-- Informa√ß√µes do √öltimo Concurso -->
            <div id="infoConcursoAtual" class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üìä √öltimo Concurso Dispon√≠vel
                </h4>
                <div id="dadosUltimoConcurso" class="text-center">
                    <!-- Dados do √∫ltimo concurso ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- Estrat√©gias de Palpite -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <!-- Estrat√©gia 1: Elimina√ß√£o Simples -->
                <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-green-800 dark:text-green-200 mb-3 text-center">
                        üå∏ Estrat√©gia 1: Elimina√ß√£o Simples
                    </h4>
                    <p class="text-sm text-green-700 dark:text-green-300 mb-4 text-center">
                        Elimina apenas os 15 n√∫meros do √∫ltimo concurso
                    </p>
                    
                    <!-- Controles de quantidade -->
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-green-700 dark:text-green-300 block mb-2">
                            Quantidade de jogos:
                        </label>
                        <input 
                            type="number" 
                            id="quantidadeJogos1" 
                            value="1"
                            min="1"
                            max="3"
                            step="1"
                            class="px-3 py-1 text-base border border-green-300 dark:border-green-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        />
                        <span class="text-xs text-green-600 dark:text-green-400 block mt-1">
                            M√°x: 3 jogos (n√∫meros √∫nicos dispon√≠veis)
                        </span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia1" 
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üå∏ Gerar Palpites
                        </button>
                    </div>
                    <div id="resultadoEstrategia1" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 1 -->
                    </div>
                </div>

                <!-- Estrat√©gia 2: Baseada em Frequ√™ncia -->
                <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-blue-800 dark:text-blue-200 mb-3 text-center">
                        üìä Estrat√©gia 2: Baseada em Frequ√™ncia
                    </h4>
                    <p class="text-sm text-blue-700 dark:text-blue-300 mb-4 text-center">
                        Equilibra n√∫meros frequentes, m√©dios e raros
                    </p>
                    
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-blue-700 dark:text-blue-300 block mb-2">
                            Analisar √∫ltimos:
                        </label>
                        <input 
                            type="number" 
                            id="periodosAnalise" 
                            value="50"
                            min="20"
                            max="100"
                            class="px-3 py-1 text-base border border-blue-300 dark:border-blue-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        >
                        <span class="text-xs text-blue-600 dark:text-blue-400 block mt-1">
                            concursos
                        </span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia2" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üìä Gerar Palpite
                        </button>
                    </div>
                    <div id="resultadoEstrategia2" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 2 -->
                    </div>
                </div>

                <!-- Estrat√©gia 3: Combina√ß√£o Inteligente -->
                <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-purple-800 dark:text-purple-200 mb-3 text-center">
                        üé∞ Estrat√©gia 3: Combina√ß√£o Inteligente
                    </h4>
                    <p class="text-sm text-purple-700 dark:text-purple-300 mb-4 text-center">
                        Elimina √∫ltimo concurso + equilibra por faixas
                    </p>
                    
                    <!-- Controles de quantidade -->
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-purple-700 dark:text-purple-300 block mb-2">
                            Quantidade de jogos:
                        </label>
                        <input 
                            type="number" 
                            id="quantidadeJogos3" 
                            value="5"
                            min="1"
                            max="10"
                            class="px-3 py-1 text-base border border-purple-300 dark:border-purple-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        >
                        <span class="text-xs text-purple-600 dark:text-purple-400 block mt-1">
                            M√°x: 10 jogos variados
                        </span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia3" 
                            class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üé∞ Gerar Palpites
                        </button>
                    </div>
                    <div id="resultadoEstrategia3" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 3 -->
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o dos N√∫meros -->
            <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center">
                    üîç Status dos N√∫meros (1-25) - Baseado em Dados Reais
                </h4>
                
                <!-- Grid de N√∫meros Visual -->
                <div class="mb-4">
                    <div id="gridNumerosVisual" class="grid grid-cols-5 gap-2">
                        <!-- N√∫meros de 01 a 25 ser√£o gerados aqui -->
                    </div>
                </div>
                
                <!-- Legenda -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-xs">
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-green-500 rounded mr-2"></div>
                        <span>Frequente</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-blue-500 rounded mr-2"></div>
                        <span>M√©dio</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-yellow-500 rounded mr-2"></div>
                        <span>Raro</span>
                    </div>
                    <div class="flex items-center">
                        <div class="w-4 h-4 bg-red-500 rounded mr-2"></div>
                        <span>√öltimo sorteio</span>
                    </div>
                </div>
            </div>

            <!-- Hist√≥rico de Palpites -->
            <div id="historicoPalpites" class="bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900 dark:to-orange-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4">
                <h4 class="text-lg font-semibold text-yellow-800 dark:text-yellow-200 mb-4 text-center">
                    üìã Hist√≥rico de Palpites Gerados
                </h4>
                <div id="listaPalpites" class="space-y-2">
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                </div>
                <div class="text-center mt-4">
                    <button 
                        id="limparHistorico" 
                        class="bg-yellow-500 hover:bg-yellow-600 text-white text-sm py-2 px-4 rounded-lg transition-colors"
                    >
                        üóëÔ∏è Limpar Hist√≥rico
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Popup "Como Funciona" -->
        <div id="modalComoFunciona" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-gradient-to-r from-purple-500 to-indigo-500 text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">
                        üå∏ Gerador Inteligente - Baseado em Dados Reais da Caixa
                    </h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <!-- Estrat√©gia 1 -->
                    <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-3">
                            üå∏ Estrat√©gia 1: Elimina√ß√£o Simples
                        </h3>
                        <div class="space-y-3 text-green-700 dark:text-green-300">
                            <p><strong>Conceito:</strong> Remove apenas os 15 n√∫meros que sa√≠ram no √∫ltimo concurso oficial.</p>
                            <p><strong>L√≥gica:</strong> Estatisticamente, √© extremamente raro os mesmos 15 n√∫meros sa√≠rem consecutivamente.</p>
                            <p><strong>Vantagem:</strong> Deixa 10 n√∫meros dispon√≠veis (25-15=10) para formar novos jogos √∫nicos.</p>
                        </div>
                    </div>

                    <!-- Estrat√©gia 2 -->
                    <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-blue-800 dark:text-blue-200 mb-3">
                            üìä Estrat√©gia 2: Baseada em Frequ√™ncia
                        </h3>
                        <div class="space-y-3 text-blue-700 dark:text-blue-300">
                            <p><strong>Conceito:</strong> Analisa a frequ√™ncia real de cada n√∫mero nos √∫ltimos N concursos.</p>
                            <p><strong>M√©todo:</strong> Equilibra n√∫meros frequentes (que saem muito), m√©dios e raros (que saem pouco).</p>
                            <p><strong>Intelig√™ncia:</strong> Usa estat√≠sticas reais da API da Caixa para gerar combina√ß√µes balanceadas.</p>
                        </div>
                    </div>

                    <!-- Estrat√©gia 3 -->
                    <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-purple-800 dark:text-purple-200 mb-3">
                            üé∞ Estrat√©gia 3: Combina√ß√£o Inteligente
                        </h3>
                        <div class="space-y-3 text-purple-700 dark:text-purple-300">
                            <p><strong>Conceito:</strong> Combina elimina√ß√£o do √∫ltimo sorteio + distribui√ß√£o por faixas de n√∫meros.</p>
                            <p><strong>Distribui√ß√£o:</strong> Equilibra entre n√∫meros baixos (1-8), m√©dios (9-17) e altos (18-25).</p>
                            <p><strong>Flexibilidade:</strong> Permite m√∫ltiplos jogos com varia√ß√µes inteligentes.</p>
                        </div>
                    </div>

                    <!-- Base de Dados -->
                    <div class="rounded-lg p-4" style="background-color: #f1daf1; border: 1px solid #cf7dcd;">
                        <h3 class="text-xl font-bold mb-3" style="color: #381537;">
                            üìä Base de Dados Reais
                        </h3>
                        <div class="space-y-2" style="color: #5d225c;">
                            <p>‚Ä¢ <strong>Fonte:</strong> API oficial da Caixa Econ√¥mica Federal</p>
                            <p>‚Ä¢ <strong>Concursos:</strong> Do primeiro (1) at√© o √∫ltimo dispon√≠vel</p>
                            <p>‚Ä¢ <strong>Atualiza√ß√£o:</strong> Sempre busca dados mais recentes da API</p>
                            <p>‚Ä¢ <strong>An√°lise:</strong> Frequ√™ncia, padr√µes e distribui√ß√µes reais</p>
                            <p>‚Ä¢ <strong>Confiabilidade:</strong> 100% baseado em dados oficiais</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-b-lg text-center">
                    <button 
                        id="fecharModal" 
                        class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-6 rounded-lg transition-colors"
                    >
                        ‚úÖ Entendi, Vamos Gerar Palpites!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Detectar tema escuro
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Elementos do DOM
        const concursoInicio = document.getElementById('concursoInicio');
        const concursoFim = document.getElementById('concursoFim');
        const buscarBtn = document.getElementById('buscarBtn');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressPercent = document.getElementById('progressPercent');
        const cancelarBtn = document.getElementById('cancelarBtn');
        const erro = document.getElementById('erro');
        const erroMsg = document.getElementById('erroMsg');
        const resultados = document.getElementById('resultados');
        const tabelaBody = document.getElementById('tabelaBody');
        const destacarPares = document.getElementById('destacarPares');
        const destacarImpares = document.getElementById('destacarImpares');
        const ordenarCrescente = document.getElementById('ordenarCrescente');
        const ordenarConcursoDecrescente = document.getElementById('ordenarConcursoDecrescente');

        // Vari√°veis globais
        let todosResultados = [];
        let carregamentoAtivo = false;
        let ultimoConcursoNumero = 0;
        let dadosEstatisticos = {};
        let historicoPalpitesData = [];

        // Fun√ß√£o para formatar data
        function formatarData(dataStr) {
            if (!dataStr) return 'N/A';
            
            try {
                let data;
                
                if (dataStr instanceof Date) {
                    data = dataStr;
                } else if (typeof dataStr === 'string') {
                    if (dataStr.includes('-')) {
                        data = new Date(dataStr);
                    } else if (dataStr.includes('/')) {
                        const [dia, mes, ano] = dataStr.split('/');
                        data = new Date(ano, mes - 1, dia);
                    } else if (!isNaN(dataStr)) {
                        data = new Date(parseInt(dataStr));
                    } else {
                        data = new Date(dataStr);
                    }
                } else {
                    data = new Date(dataStr);
                }
                
                if (data && !isNaN(data.getTime())) {
                    return data.toLocaleDateString('pt-BR');
                } else {
                    return 'N/A';
                }
            } catch (error) {
                console.error('Erro ao formatar data:', dataStr, error);
                return 'N/A';
            }
        }

        // Fun√ß√£o para buscar √∫ltimo concurso da API da Caixa
        async function buscarUltimoConcursoDaCaixa() {
            console.log('üîç Buscando √∫ltimo concurso na API oficial da Caixa...');
            
            // Tentar API principal primeiro
            for (let tentativa = 1; tentativa <= 3; tentativa++) {
                try {
                    console.log(`üåê Tentativa ${tentativa}: API principal da Caixa...`);
                    const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/lotofacil', {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero && data.numero > 0) {
                            console.log(`‚úÖ SUCESSO! √öltimo concurso da Caixa: ${data.numero}`);
                            atualizarStatusApi('Conectado √† API da Caixa', data.numero, data.dataApuracao, true);
                            return data.numero;
                        }
                    }
                    
                    console.log(`‚ö†Ô∏è Tentativa ${tentativa} falhou: ${response.status}`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                } catch (error) {
                    console.log(`‚ùå Erro na tentativa ${tentativa}:`, error.message);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            
            // Busca sequencial reversa
            console.log('üîÑ Fazendo busca sequencial na API da Caixa...');
            
            for (let concurso = 3500; concurso >= 3400; concurso--) {
                try {
                    console.log(`üîç Testando concurso ${concurso} na API...`);
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/lotofacil/${concurso}`);
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero === concurso && data.dezenasSorteadasOrdemSorteio) {
                            console.log(`üéØ ENCONTRADO na API! √öltimo concurso v√°lido: ${concurso}`);
                            atualizarStatusApi('API da Caixa funcionando', concurso, data.dataApuracao, true);
                            return concurso;
                        }
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                } catch (error) {
                    continue;
                }
            }
            
            // Fallback
            console.log('‚ö†Ô∏è Usando √∫ltimo concurso conhecido');
            const ultimoConhecido = 3479;
            atualizarStatusApi('√öltimo concurso conhecido', ultimoConhecido, 'N/A', false);
            return ultimoConhecido;
        }

        // Fun√ß√£o para atualizar status da API
        function atualizarStatusApi(status, numeroConcurso, dataApuracao, online) {
            const statusDiv = document.getElementById('statusApi');
            const statusTexto = document.getElementById('statusTexto');
            const numeroSpan = document.getElementById('numeroUltimoConcurso');
            const dataSpan = document.getElementById('dataUltimoConcurso');
            
            statusTexto.textContent = status;
            numeroSpan.textContent = numeroConcurso;
            dataSpan.textContent = formatarData(dataApuracao);
            
            if (online) {
                statusDiv.className = 'mb-4 p-4 rounded-lg border bg-green-50 border-green-200 text-green-800';
            } else {
                statusDiv.className = 'mb-4 p-4 rounded-lg border bg-yellow-50 border-yellow-200 text-yellow-800';
            }
            
            statusDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar progresso
        function atualizarProgresso(atual, total) {
            const porcentagem = Math.round((atual / total) * 100);
            progressBar.style.width = `${porcentagem}%`;
            progressText.textContent = `${atual} / ${total} concursos`;
            progressPercent.textContent = `${porcentagem}%`;
        }

        // Fun√ß√£o para cancelar carregamento
        function cancelarCarregamento() {
            carregamentoAtivo = false;
            loading.classList.add('hidden');
            buscarBtn.disabled = false;
            loadingText.textContent = 'Carregamento cancelado';
        }

        // FUN√á√ÉO PRINCIPAL: Carregar TODOS os concursos da API da Caixa
        async function carregarTodosOsConcursosDaCaixa() {
            console.log('üöÄ INICIANDO: Carregar TODOS os concursos da API da Caixa...');
            
            loading.classList.remove('hidden');
            resultados.classList.add('hidden');
            erro.classList.add('hidden');
            buscarBtn.disabled = true;
            carregamentoAtivo = true;

            try {
                loadingText.textContent = 'üîç Buscando √∫ltimo concurso na API oficial da Caixa...';
                const ultimoConcurso = await buscarUltimoConcursoDaCaixa();
                
                if (!ultimoConcurso) {
                    throw new Error('N√£o foi poss√≠vel determinar o √∫ltimo concurso na API da Caixa');
                }

                ultimoConcursoNumero = ultimoConcurso;
                concursoInicio.value = 1;
                concursoFim.value = ultimoConcurso;
                
                console.log(`‚úÖ Carregando concursos 1 at√© ${ultimoConcurso} da API oficial`);

                const totalConcursos = ultimoConcurso;
                const tamanhoBatch = 8;
                let concursosCarregados = 0;

                loadingText.textContent = `üì• Carregando ${totalConcursos} concursos da API da Caixa...`;
                atualizarProgresso(0, totalConcursos);

                todosResultados = [];

                for (let i = 1; i <= ultimoConcurso && carregamentoAtivo; i += tamanhoBatch) {
                    const fimBatch = Math.min(i + tamanhoBatch - 1, ultimoConcurso);
                    
                    loadingText.textContent = `üì• API Caixa: concursos ${i} a ${fimBatch}...`;
                    
                    const promisesBatch = [];
                    for (let j = i; j <= fimBatch; j++) {
                        promisesBatch.push(buscarConcursoDaCaixaComRetry(j));
                    }

                    const resultadosBatch = await Promise.allSettled(promisesBatch);
                    
                    resultadosBatch.forEach((resultado, index) => {
                        if (resultado.status === 'fulfilled' && resultado.value) {
                            todosResultados.push(resultado.value);
                        }
                        concursosCarregados++;
                        atualizarProgresso(concursosCarregados, totalConcursos);
                    });

                    // Atualizar interface em tempo real
                    if (todosResultados.length > 0) {
                        todosResultados.sort((a, b) => a.numero - b.numero);
                        exibirTodosResultados();
                    }

                    await new Promise(resolve => setTimeout(resolve, 300));
                }

                if (!carregamentoAtivo) {
                    throw new Error('Carregamento cancelado pelo usu√°rio');
                }

                todosResultados.sort((a, b) => a.numero - b.numero);

                if (todosResultados.length === 0) {
                    throw new Error('Nenhum resultado encontrado na API da Caixa. Verifique sua conex√£o.');
                }

                loadingText.textContent = `‚úÖ SUCESSO! ${todosResultados.length} concursos carregados da API oficial da Caixa`;
                exibirTodosResultados();
                gerarEstatisticasReais();
                inicializarGeradorPalpitesInteligente();
                
                console.log(`üéâ CONCLU√çDO: ${todosResultados.length} concursos da API da Caixa carregados!`);
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar concursos da API da Caixa:', error);
                erroMsg.textContent = `Erro: ${error.message}`;
                erro.classList.remove('hidden');
            } finally {
                loading.classList.add('hidden');
                buscarBtn.disabled = false;
                carregamentoAtivo = false;
            }
        }

        // Fun√ß√£o para buscar um concurso da API da Caixa com retry
        async function buscarConcursoDaCaixaComRetry(numero, tentativas = 3) {
            for (let i = 0; i < tentativas; i++) {
                try {
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/lotofacil/${numero}`, {
                        timeout: 10000,
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    if (!response.ok) {
                        if (i === tentativas - 1) return null;
                        await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                        continue;
                    }
                    const data = await response.json();
                    
                    // Validar dados essenciais
                    if (data && data.numero === numero && data.dezenasSorteadasOrdemSorteio && data.dezenasSorteadasOrdemSorteio.length === 15) {
                        return data;
                    }
                    return null;
                } catch (error) {
                    console.error(`Tentativa ${i + 1} falhou para concurso ${numero}:`, error);
                    if (i === tentativas - 1) return null;
                    await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                }
            }
            return null;
        }

        // Fun√ß√£o para criar c√©lula de n√∫mero com destaque par/√≠mpar
        function criarCelulaNumero(numero) {
            const cellNumero = document.createElement('td');
            cellNumero.className = 'px-1 py-3 whitespace-nowrap text-center text-sm font-medium text-gray-900 dark:text-white';
            cellNumero.textContent = numero;
            cellNumero.dataset.numero = numero;

            // Aplicar cores baseado em par/√≠mpar
            aplicarDestaque(cellNumero, numero);

            return cellNumero;
        }

        // Fun√ß√£o para aplicar destaque par/√≠mpar
        function aplicarDestaque(elemento, numero) {
            elemento.classList.remove('numero-par', 'numero-impar');
            
            if (destacarPares.checked && numero % 2 === 0) {
                elemento.classList.add('numero-par');
            } else if (destacarImpares.checked && numero % 2 === 1) {
                elemento.classList.add('numero-impar');
            }
        }

        // Fun√ß√£o para calcular estat√≠sticas par/√≠mpar
        function calcularEstatisticasParImpar(numeros) {
            if (!numeros || !Array.isArray(numeros)) {
                return { pares: 0, impares: 0, texto: 'N/A' };
            }
            
            let pares = 0;
            let impares = 0;
            
            numeros.forEach(numero => {
                if (numero % 2 === 0) {
                    pares++;
                } else {
                    impares++;
                }
            });
            
            return { 
                pares, 
                impares, 
                texto: `${pares}P/${impares}I`,
                maioria: pares > impares ? 'pares' : (impares > pares ? 'impares' : 'equilibrado')
            };
        }

        // Fun√ß√£o para gerar estat√≠sticas baseadas em dados reais
        function gerarEstatisticasReais() {
            console.log('üìä Gerando estat√≠sticas baseadas em dados reais da API...');
            
            // Calcular frequ√™ncia dos n√∫meros
            const frequencia = {};
            for (let i = 1; i <= 25; i++) {
                frequencia[i] = 0;
            }
            
            // Contar apari√ß√µes reais
            todosResultados.forEach(resultado => {
                if (resultado.dezenasSorteadasOrdemSorteio) {
                    resultado.dezenasSorteadasOrdemSorteio.forEach(numero => {
                        const num = parseInt(numero);
                        if (num >= 1 && num <= 25) {
                            frequencia[num]++;
                        }
                    });
                }
            });
            
            // Classificar por frequ√™ncia
            const numerosOrdenados = Object.entries(frequencia)
                .map(([num, freq]) => ({ numero: parseInt(num), frequencia: freq }))
                .sort((a, b) => b.frequencia - a.frequencia);
            
            // Dividir em categorias
            const totalNumeros = numerosOrdenados.length;
            const terco = Math.floor(totalNumeros / 3);
            
            dadosEstatisticos = {
                frequentes: numerosOrdenados.slice(0, terco).map(item => item.numero),
                medios: numerosOrdenados.slice(terco, terco * 2).map(item => item.numero),
                raros: numerosOrdenados.slice(terco * 2).map(item => item.numero),
                frequencia: frequencia,
                totalConcursos: todosResultados.length
            };
            
            console.log('‚úÖ Estat√≠sticas reais calculadas:', dadosEstatisticos);
            
            // Gerar resumo visual
            gerarResumoEstatisticoReal();
        }

        // Fun√ß√£o para exibir todos os resultados na tabela
        function exibirTodosResultados() {
            tabelaBody.innerHTML = '';

            const resultadosParaExibir = [...todosResultados].sort((a, b) => {
                if (ordenarConcursoDecrescente.checked) {
                    return b.numero - a.numero;
                } else {
                    return a.numero - b.numero;
                }
            });

            resultadosParaExibir.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700';
                row.dataset.concurso = data.numero;

                // N√∫mero do concurso
                const cellConcurso = document.createElement('td');
                cellConcurso.className = 'px-2 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white';
                cellConcurso.textContent = data.numero;
                row.appendChild(cellConcurso);

                // Data do sorteio
                const cellData = document.createElement('td');
                cellData.className = 'px-2 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300';
                
                const dataFormatada = formatarData(data.dataApuracao) || 
                                    formatarData(data.dataSorteio) || 
                                    formatarData(data.data) || 
                                    'N/A';
                                    
                cellData.textContent = dataFormatada;
                row.appendChild(cellData);

                // Dezenas sorteadas (15 n√∫meros da Lotof√°cil)
                if (data.dezenasSorteadasOrdemSorteio) {
                    let numerosExibir = [...data.dezenasSorteadasOrdemSorteio];
                    if (ordenarCrescente.checked) {
                        numerosExibir.sort((a, b) => a - b);
                    }
                    
                    numerosExibir.forEach((numero, index) => {
                        const cellNumero = criarCelulaNumero(numero);
                        cellNumero.dataset.coluna = index + 1;
                        cellNumero.dataset.numeroOriginal = data.dezenasSorteadasOrdemSorteio[index];
                        row.appendChild(cellNumero);
                    });
                }

                // Estat√≠sticas Par/√çmpar
                const cellEstatisticas = document.createElement('td');
                cellEstatisticas.className = 'px-2 py-3 whitespace-nowrap text-center';
                
                const stats = calcularEstatisticasParImpar(data.dezenasSorteadasOrdemSorteio);
                const spanStats = document.createElement('span');
                spanStats.className = 'inline-flex items-center px-2 py-1 text-xs font-bold rounded-full';
                
                if (stats.maioria === 'pares') {
                    spanStats.className += ' bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';
                } else if (stats.maioria === 'impares') {
                    spanStats.className += ' bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200';
                } else {
                    spanStats.className += ' bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';
                }
                
                spanStats.textContent = stats.texto;
                spanStats.title = `${stats.pares} n√∫meros pares e ${stats.impares} n√∫meros √≠mpares`;
                
                cellEstatisticas.appendChild(spanStats);
                row.appendChild(cellEstatisticas);

                tabelaBody.appendChild(row);
            });

            resultados.classList.remove('hidden');
            document.getElementById('toggleTabelaContainer').classList.remove('hidden');
            aplicarFiltros();
        }

        // Fun√ß√£o para aplicar filtros
        function aplicarFiltros() {
            const filtros = [];
            for (let i = 1; i <= 15; i++) {
                const filtro = document.getElementById(`filtro${i}`).value.trim();
                filtros.push(filtro);
            }

            const rows = tabelaBody.querySelectorAll('tr');
            let resultadosVisiveis = 0;
            
            rows.forEach(row => {
                let mostrar = true;
                
                filtros.forEach((filtro, index) => {
                    if (filtro) {
                        const celula = row.querySelector(`td[data-coluna="${index + 1}"]`);
                        if (celula) {
                            const numero = celula.textContent.trim();
                            const numerosFiltro = filtro.split(',').map(n => n.trim());
                            const encontrou = numerosFiltro.some(nf => {
                                return numero === nf || numero.includes(nf);
                            });
                            if (!encontrou) {
                                mostrar = false;
                            }
                        }
                    }
                });

                row.style.display = mostrar ? '' : 'none';
                if (mostrar) {
                    resultadosVisiveis++;
                }
            });

            atualizarContador(resultadosVisiveis, todosResultados.length);
        }

        // Fun√ß√£o para atualizar contador de resultados
        function atualizarContador(visiveis, total) {
            const contador = document.getElementById('contadorResultados');
            if (visiveis === total) {
                contador.textContent = `üìä ${total} concursos da API da Caixa (COMPLETO)`;
            } else {
                contador.textContent = `üìä ${visiveis} de ${total} concursos (filtrado)`;
            }
        }

        // Fun√ß√£o para atualizar destaques
        function atualizarDestaques() {
            const numeros = document.querySelectorAll('td[data-numero]');
            numeros.forEach(elemento => {
                const numero = parseInt(elemento.dataset.numero);
                aplicarDestaque(elemento, numero);
            });
        }

        // Fun√ß√£o para gerar resumo estat√≠stico baseado em dados reais
        function gerarResumoEstatisticoReal() {
            if (todosResultados.length === 0 || !dadosEstatisticos.frequencia) return;

            const resumoDiv = document.getElementById('resumoEstatistico');
            const estatisticasDiv = document.getElementById('estatisticasGerais');
            const graficoDiv = document.getElementById('graficoBarras');
            const padroesDiv = document.getElementById('padroes');
            const frequenciaGrid = document.getElementById('frequenciaNumerosGrid');

            // Calcular estat√≠sticas par/√≠mpar
            let totalPares = 0, totalImpares = 0;
            let concursosMaioriaPares = 0, concursosMaioriaImpares = 0, concursosEquilibrados = 0;
            const padroesCombinacoes = {};

            todosResultados.forEach(resultado => {
                const stats = calcularEstatisticasParImpar(resultado.dezenasSorteadasOrdemSorteio);
                totalPares += stats.pares;
                totalImpares += stats.impares;

                if (stats.maioria === 'pares') concursosMaioriaPares++;
                else if (stats.maioria === 'impares') concursosMaioriaImpares++;
                else concursosEquilibrados++;

                const padrao = stats.texto;
                padroesCombinacoes[padrao] = (padroesCombinacoes[padrao] || 0) + 1;
            });

            const totalConcursos = todosResultados.length;
            const percPares = ((concursosMaioriaPares / totalConcursos) * 100).toFixed(1);
            const percImpares = ((concursosMaioriaImpares / totalConcursos) * 100).toFixed(1);
            const percEquilibrados = ((concursosEquilibrados / totalConcursos) * 100).toFixed(1);

            // Cards estat√≠sticos
            estatisticasDiv.innerHTML = `
                <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600 dark:text-blue-300">${concursosMaioriaPares}</div>
                    <div class="text-sm text-blue-800 dark:text-blue-200">Concursos com</div>
                    <div class="text-sm font-semibold text-blue-800 dark:text-blue-200">Maioria Pares</div>
                    <div class="text-xs text-blue-600 dark:text-blue-400">${percPares}%</div>
                </div>
                <div class="p-4 rounded-lg text-center" style="background-color: #f1daf1;">
                    <div class="text-2xl font-bold" style="color: #672666;">${concursosMaioriaImpares}</div>
                    <div class="text-sm" style="color: #381537;">Concursos com</div>
                    <div class="text-sm font-semibold" style="color: #381537;">Maioria √çmpares</div>
                    <div class="text-xs" style="color: #5d225c;">${percImpares}%</div>
                </div>
                <div class="bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-yellow-600 dark:text-yellow-300">${concursosEquilibrados}</div>
                    <div class="text-sm text-yellow-800 dark:text-yellow-200">Concursos</div>
                    <div class="text-sm font-semibold text-yellow-800 dark:text-yellow-200">Equilibrados</div>
                    <div class="text-xs text-yellow-600 dark:text-yellow-400">${percEquilibrados}%</div>
                </div>
                <div class="p-4 rounded-lg text-center" style="background-color: #eac7ea;">
                    <div class="text-lg font-bold" style="color: #672666;">${totalPares}P / ${totalImpares}I</div>
                    <div class="text-sm" style="color: #381537;">Total de</div>
                    <div class="text-sm font-semibold" style="color: #381537;">N√∫meros Sorteados</div>
                    <div class="text-xs" style="color: #5d225c;">${totalConcursos} concursos</div>
                </div>
            `;

            // Grid de frequ√™ncia dos n√∫meros
            if (frequenciaGrid) {
                let gridHTML = '';
                for (let num = 1; num <= 25; num++) {
                    const freq = dadosEstatisticos.frequencia[num] || 0;
                    const percentual = ((freq / totalConcursos) * 100).toFixed(1);
                    
                    let classe = 'numero-medio';
                    if (dadosEstatisticos.frequentes.includes(num)) {
                        classe = 'numero-frequente';
                    } else if (dadosEstatisticos.raros.includes(num)) {
                        classe = 'numero-raro';
                    }
                    
                    gridHTML += `
                        <div class="${classe} w-12 h-12 flex flex-col items-center justify-center rounded-lg text-xs font-bold">
                            <div>${num.toString().padStart(2, '0')}</div>
                            <div class="text-xs">${freq}</div>
                        </div>
                    `;
                }
                frequenciaGrid.innerHTML = gridHTML;
            }

            // Gr√°fico de barras visual
            const maxValor = Math.max(concursosMaioriaPares, concursosMaioriaImpares, concursosEquilibrados);
            graficoDiv.innerHTML = `
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Maioria Pares:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="bg-blue-500 h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosMaioriaPares/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosMaioriaPares}</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Maioria √çmpares:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosMaioriaImpares/maxValor)*100}%; background-color: #c157bf;">
                            <span class="text-xs text-white font-bold">${concursosMaioriaImpares}</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Equilibrados:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="bg-yellow-500 h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosEquilibrados/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosEquilibrados}</span>
                        </div>
                    </div>
                </div>
            `;

            // Insights baseados em dados reais
            const numeroMaisFrequente = dadosEstatisticos.frequentes[0];
            const numeroMenosFrequente = dadosEstatisticos.raros[dadosEstatisticos.raros.length - 1];
            const freqMaior = dadosEstatisticos.frequencia[numeroMaisFrequente];
            const freqMenor = dadosEstatisticos.frequencia[numeroMenosFrequente];

            let insights = `
                <div class="space-y-3">
                    <p><strong>üìä An√°lise Real:</strong> Dados de ${totalConcursos} concursos oficiais da Caixa Econ√¥mica Federal.</p>
                    <p><strong>üéØ N√∫mero mais frequente:</strong> ${numeroMaisFrequente} (saiu ${freqMaior} vezes - ${((freqMaior/totalConcursos)*100).toFixed(1)}%)</p>
                    <p><strong>‚≠ê N√∫mero mais raro:</strong> ${numeroMenosFrequente} (saiu ${freqMenor} vezes - ${((freqMenor/totalConcursos)*100).toFixed(1)}%)</p>
                    <p><strong>üîÑ Equil√≠brio:</strong> A diferen√ßa entre o mais frequente e mais raro √© de ${freqMaior - freqMenor} apari√ß√µes.</p>
                    <p><strong>üå∏ Lotof√°cil:</strong> Com 15 n√∫meros por sorteio, cada n√∫mero teoricamente deveria aparecer em 60% dos concursos.</p>
                </div>
            `;

            padroesDiv.innerHTML = insights;

            resumoDiv.classList.remove('hidden');
        }

        // GERADOR DE PALPITES INTELIGENTE

        // Fun√ß√£o para inicializar o gerador de palpites inteligente
        function inicializarGeradorPalpitesInteligente() {
            if (todosResultados.length === 0 || !dadosEstatisticos.frequencia) return;

            console.log('üß† Inicializando gerador de palpites inteligente...');

            // Obter √∫ltimo concurso
            const ultimoConcurso = todosResultados.reduce((ultimo, atual) => {
                return atual.numero > ultimo.numero ? atual : ultimo;
            });

            atualizarInfoUltimoConcurso(ultimoConcurso);
            criarGridNumerosVisualizacao();

            document.getElementById('geradorPalpites').classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar informa√ß√µes do √∫ltimo concurso
        function atualizarInfoUltimoConcurso(ultimoConcurso) {
            const dadosDiv = document.getElementById('dadosUltimoConcurso');
            
            if (!ultimoConcurso) {
                dadosDiv.innerHTML = '<p class="text-gray-500">Nenhum dado dispon√≠vel</p>';
                return;
            }

            const numeros = (ultimoConcurso.dezenasSorteadasOrdemSorteio || []);

            const numerosHTML = numeros
                .map(num => `<span class="inline-block bg-purple-100 dark:bg-purple-800 text-purple-800 dark:text-purple-200 px-2 py-1 rounded-full text-sm font-bold mx-1">${num}</span>`)
                .join('');

            const dataFormatada = formatarData(ultimoConcurso.dataApuracao) || 
                                formatarData(ultimoConcurso.dataSorteio) || 
                                'N/A';

            dadosDiv.innerHTML = `
                <div class="space-y-4">
                    <div class="text-lg font-semibold text-gray-800 dark:text-gray-200">
                        Concurso: <span class="text-purple-600 dark:text-purple-400">${ultimoConcurso.numero}</span>
                    </div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Data: ${dataFormatada}
                    </div>
                    
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900 dark:to-pink-900 p-4 rounded-lg border border-purple-200 dark:border-purple-700">
                        <div class="text-sm font-semibold mb-3 text-center" style="color: #381537;">üå∏ N√∫meros Sorteados (15):</div>
                        <div class="flex flex-wrap gap-1 justify-center">
                            ${numerosHTML}
                        </div>
                    </div>
                </div>
            `;
        }

        // Fun√ß√£o para criar grid visual dos n√∫meros com base em dados reais
        function criarGridNumerosVisualizacao() {
            const grid = document.getElementById('gridNumerosVisual');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            // Obter n√∫meros do √∫ltimo concurso
            const ultimoConcurso = todosResultados.reduce((ultimo, atual) => {
                return atual.numero > ultimo.numero ? atual : ultimo;
            });
            
            const numerosUltimoConcurso = new Set((ultimoConcurso.dezenasSorteadasOrdemSorteio || []).map(n => parseInt(n)));
            
            for (let i = 1; i <= 25; i++) {
                const div = document.createElement('div');
                div.className = 'w-12 h-12 flex flex-col items-center justify-center rounded-lg border-2 font-bold text-xs cursor-pointer transition-all duration-200';
                
                const freq = dadosEstatisticos.frequencia[i] || 0;
                const percentual = ((freq / dadosEstatisticos.totalConcursos) * 100).toFixed(0);
                
                // Determinar classe baseada na frequ√™ncia e √∫ltimo sorteio
                if (numerosUltimoConcurso.has(i)) {
                    div.classList.add('numero-sorteado');
                } else if (dadosEstatisticos.frequentes.includes(i)) {
                    div.classList.add('numero-frequente');
                } else if (dadosEstatisticos.raros.includes(i)) {
                    div.classList.add('numero-raro');
                } else {
                    div.classList.add('numero-medio');
                }
                
                div.innerHTML = `
                    <div>${i.toString().padStart(2, '0')}</div>
                    <div class="text-xs">${percentual}%</div>
                `;
                
                div.dataset.numero = i;
                div.dataset.frequencia = freq;
                
                grid.appendChild(div);
            }
        }

        // ESTRAT√âGIAS DE GERA√á√ÉO DE PALPITES

        // Estrat√©gia 1: Elimina√ß√£o Simples
        function gerarEstrategia1() {
            const quantidadeJogos = parseInt(document.getElementById('quantidadeJogos1').value) || 1;
            
            if (quantidadeJogos < 1 || quantidadeJogos > 3) {
                mostrarModal('Erro', 'Quantidade deve ser entre 1 e 3 jogos √∫nicos.');
                return;
            }

            // Obter √∫ltimo concurso
            const ultimoConcurso = todosResultados.reduce((ultimo, atual) => {
                return atual.numero > ultimo.numero ? atual : ultimo;
            });

            const numerosEliminados = new Set((ultimoConcurso.dezenasSorteadasOrdemSorteio || []).map(n => parseInt(n)));
            const numerosDisponiveis = [];
            
            for (let i = 1; i <= 25; i++) {
                if (!numerosEliminados.has(i)) {
                    numerosDisponiveis.push(i);
                }
            }

            if (numerosDisponiveis.length < 15) {
                mostrarModal('Erro', `N√∫meros dispon√≠veis insuficientes: apenas ${numerosDisponiveis.length} dispon√≠veis.`);
                return;
            }

            const jogosGerados = [];
            const numerosUsados = new Set();

            for (let i = 0; i < quantidadeJogos; i++) {
                const poolDisponivel = numerosDisponiveis.filter(num => !numerosUsados.has(num));
                
                if (poolDisponivel.length < 15) break;

                let jogo;
                if (poolDisponivel.length === 15) {
                    jogo = poolDisponivel.sort((a, b) => a - b);
                } else {
                    jogo = gerarJogoEquilibrado(poolDisponivel, 15);
                }

                jogosGerados.push(jogo);
                jogo.forEach(num => numerosUsados.add(num));
            }

            adicionarAoHistorico(1, jogosGerados, `Eliminou concurso ${ultimoConcurso.numero}`);
            exibirResultadoEstrategia(1, jogosGerados);
        }

        // Estrat√©gia 2: Baseada em Frequ√™ncia
        function gerarEstrategia2() {
            const periodosAnalise = parseInt(document.getElementById('periodosAnalise').value) || 50;
            
            if (periodosAnalise < 20 || periodosAnalise > 100) {
                mostrarModal('Erro', 'Per√≠odo deve ser entre 20 e 100 concursos.');
                return;
            }

            // Pegar √∫ltimos N concursos
            const ultimosConcursos = [...todosResultados]
                .sort((a, b) => b.numero - a.numero)
                .slice(0, periodosAnalise);

            // Calcular frequ√™ncia para o per√≠odo espec√≠fico
            const frequenciaPeriodo = {};
            for (let i = 1; i <= 25; i++) {
                frequenciaPeriodo[i] = 0;
            }

            ultimosConcursos.forEach(concurso => {
                if (concurso.dezenasSorteadasOrdemSorteio) {
                    concurso.dezenasSorteadasOrdemSorteio.forEach(numero => {
                        const num = parseInt(numero);
                        if (num >= 1 && num <= 25) {
                            frequenciaPeriodo[num]++;
                        }
                    });
                }
            });

            // Classificar por frequ√™ncia
            const numerosOrdenados = Object.entries(frequenciaPeriodo)
                .map(([num, freq]) => ({ numero: parseInt(num), frequencia: freq }))
                .sort((a, b) => b.frequencia - a.frequencia);

            // Dividir em categorias para este per√≠odo
            const terco = Math.floor(25 / 3);
            const frequentesPeriodo = numerosOrdenados.slice(0, terco).map(item => item.numero);
            const mediosPeriodo = numerosOrdenados.slice(terco, terco * 2).map(item => item.numero);
            const rarosPeriodo = numerosOrdenados.slice(terco * 2).map(item => item.numero);

            // Gerar jogo equilibrado: 5 frequentes, 5 m√©dios, 5 raros
            const jogo = [];
            jogo.push(...embaralharArray(frequentesPeriodo).slice(0, 5));
            jogo.push(...embaralharArray(mediosPeriodo).slice(0, 5));
            jogo.push(...embaralharArray(rarosPeriodo).slice(0, 5));

            jogo.sort((a, b) => a - b);

            adicionarAoHistorico(2, [jogo], `Freq. baseada em ${periodosAnalise} concursos`);
            exibirResultadoEstrategia(2, [jogo]);
        }

        // Estrat√©gia 3: Combina√ß√£o Inteligente
        function gerarEstrategia3() {
            const quantidadeJogos = parseInt(document.getElementById('quantidadeJogos3').value) || 5;
            
            if (quantidadeJogos < 1 || quantidadeJogos > 10) {
                mostrarModal('Erro', 'Quantidade deve ser entre 1 e 10 jogos.');
                return;
            }

            // Eliminar n√∫meros do √∫ltimo concurso
            const ultimoConcurso = todosResultados.reduce((ultimo, atual) => {
                return atual.numero > ultimo.numero ? atual : ultimo;
            });

            const numerosEliminados = new Set((ultimoConcurso.dezenasSorteadasOrdemSorteio || []).map(n => parseInt(n)));
            const numerosDisponiveis = [];
            
            for (let i = 1; i <= 25; i++) {
                if (!numerosEliminados.has(i)) {
                    numerosDisponiveis.push(i);
                }
            }

            if (numerosDisponiveis.length < 15) {
                mostrarModal('Erro', 'N√∫meros dispon√≠veis insuficientes.');
                return;
            }

            const jogosGerados = [];

            for (let i = 0; i < quantidadeJogos; i++) {
                const jogo = gerarJogoEquilibradoPorFaixas(numerosDisponiveis);
                jogosGerados.push(jogo);
            }

            adicionarAoHistorico(3, jogosGerados, `Eliminou ${ultimoConcurso.numero} + faixas`);
            exibirResultadoEstrategia(3, jogosGerados);
        }

        // FUN√á√ïES AUXILIARES

        // Fun√ß√£o para embaralhar array
        function embaralharArray(array) {
            const resultado = [...array];
            for (let i = resultado.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [resultado[i], resultado[j]] = [resultado[j], resultado[i]];
            }
            return resultado;
        }

        // Fun√ß√£o para gerar jogo equilibrado
        function gerarJogoEquilibrado(numerosDisponiveis, quantidade = 15) {
            if (numerosDisponiveis.length <= quantidade) {
                return numerosDisponiveis.sort((a, b) => a - b);
            }

            const embaralhados = embaralharArray(numerosDisponiveis);
            return embaralhados.slice(0, quantidade).sort((a, b) => a - b);
        }

        // Fun√ß√£o para gerar jogo equilibrado por faixas
        function gerarJogoEquilibradoPorFaixas(numerosDisponiveis) {
            const baixos = numerosDisponiveis.filter(n => n >= 1 && n <= 8);
            const medios = numerosDisponiveis.filter(n => n >= 9 && n <= 17);
            const altos = numerosDisponiveis.filter(n => n >= 18 && n <= 25);

            const jogo = [];
            
            // Distribuir: 5 baixos, 5 m√©dios, 5 altos (aproximadamente)
            const distribuicao = [
                { faixa: baixos, quantidade: Math.min(5, baixos.length) },
                { faixa: medios, quantidade: Math.min(5, medios.length) },
                { faixa: altos, quantidade: Math.min(5, altos.length) }
            ];

            // Ajustar para totalizar 15
            let totalEscolhido = distribuicao.reduce((sum, d) => sum + d.quantidade, 0);
            
            while (totalEscolhido < 15) {
                for (let dist of distribuicao) {
                    if (dist.quantidade < dist.faixa.length && totalEscolhido < 15) {
                        dist.quantidade++;
                        totalEscolhido++;
                    }
                }
                break;
            }

            // Escolher n√∫meros
            distribuicao.forEach(dist => {
                const escolhidos = embaralharArray(dist.faixa).slice(0, dist.quantidade);
                jogo.push(...escolhidos);
            });

            return jogo.sort((a, b) => a - b);
        }

        // Fun√ß√£o para adicionar ao hist√≥rico
        function adicionarAoHistorico(estrategia, jogos, info) {
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: estrategia,
                jogos: jogos,
                quantidade: jogos.length,
                horario: horario,
                info: info
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para exibir resultado da estrat√©gia
        function exibirResultadoEstrategia(estrategia, jogos) {
            const resultadoDiv = document.getElementById(`resultadoEstrategia${estrategia}`);
            
            let corFundo, corTexto, emoji;
            switch(estrategia) {
                case 1: 
                    corFundo = 'bg-green-100 dark:bg-green-800 border-green-300 dark:border-green-600';
                    corTexto = 'text-green-800 dark:text-green-200';
                    emoji = 'üå∏';
                    break;
                case 2:
                    corFundo = 'bg-blue-100 dark:bg-blue-800 border-blue-300 dark:border-blue-600';
                    corTexto = 'text-blue-800 dark:text-blue-200';
                    emoji = 'üìä';
                    break;
                case 3:
                    corFundo = 'bg-purple-100 dark:bg-purple-800 border-purple-300 dark:border-purple-600';
                    corTexto = 'text-purple-800 dark:text-purple-200';
                    emoji = 'üé∞';
                    break;
            }
            
            let jogosHTML = '';
            jogos.forEach((jogo, index) => {
                const numerosHTML = jogo
                    .map(num => `<span class="numero-palpite px-2 py-1 rounded-full text-xs font-bold font-mono">${num.toString().padStart(2, '0')}</span>`)
                    .join(' ');
                
                jogosHTML += `
                    <div class="mb-3 p-3 bg-white dark:bg-gray-800 rounded border">
                        <div class="text-xs font-medium ${corTexto} mb-2 text-center">
                            Jogo ${index + 1}:
                        </div>
                        <div class="flex flex-wrap gap-1 justify-center">
                            ${numerosHTML}
                        </div>
                    </div>
                `;
            });
            
            resultadoDiv.innerHTML = `
                <div class="${corFundo} border rounded-lg p-3">
                    <div class="text-sm font-medium ${corTexto} mb-3">
                        ${emoji} ${jogos.length} Palpite(s) Gerado(s):
                    </div>
                    ${jogosHTML}
                    
                    <div class="text-xs ${corTexto} mt-2 text-center">
                        ${jogos.length} jogo(s) | Baseado em dados reais da API da Caixa
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar hist√≥rico de palpites
        function atualizarHistoricoPalpites() {
            const listaDiv = document.getElementById('listaPalpites');
            
            if (historicoPalpitesData.length === 0) {
                listaDiv.innerHTML = `
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                `;
                return;
            }
            
            const historicoHTML = historicoPalpitesData
                .slice(0, 10)
                .map(palpite => {
                    let estrategiaTexto;
                    switch(palpite.estrategia) {
                        case 1: estrategiaTexto = 'üå∏ Elimina√ß√£o'; break;
                        case 2: estrategiaTexto = 'üìä Frequ√™ncia'; break;
                        case 3: estrategiaTexto = 'üé∞ Inteligente'; break;
                        default: estrategiaTexto = '‚ùì Desconhecida';
                    }
                    
                    let numerosParaExibir = [];
                    if (palpite.jogos && palpite.jogos.length > 0) {
                        numerosParaExibir = palpite.jogos[0];
                    }
                    
                    const numerosHTML = numerosParaExibir
                        .map(num => `<span class="inline-block bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded text-xs font-mono">${num.toString().padStart(2, '0')}</span>`)
                        .join(' ');
                    
                    return `
                        <div class="bg-white dark:bg-gray-800 border border-yellow-300 dark:border-yellow-600 rounded-lg p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-yellow-800 dark:text-yellow-200">
                                    ${estrategiaTexto} - ${palpite.info}
                                </span>
                                <span class="text-xs text-yellow-600 dark:text-yellow-400">
                                    ${palpite.horario}
                                </span>
                            </div>
                            <div class="flex flex-wrap gap-1">
                                ${numerosHTML}
                            </div>
                        </div>
                    `;
                })
                .join('');
            
            listaDiv.innerHTML = historicoHTML;
        }

        // Fun√ß√£o para mostrar modal personalizada
        function mostrarModal(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">${titulo}</h3>
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Event listeners
        buscarBtn.addEventListener('click', carregarTodosOsConcursosDaCaixa);
        cancelarBtn.addEventListener('click', cancelarCarregamento);
        
        // Event listeners para filtros
        for (let i = 1; i <= 15; i++) {
            const filtro = document.getElementById(`filtro${i}`);
            filtro.addEventListener('input', aplicarFiltros);
        }

        destacarPares.addEventListener('change', atualizarDestaques);
        destacarImpares.addEventListener('change', atualizarDestaques);
        
        ordenarCrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
                gerarEstatisticasReais();
            }
        });

        ordenarConcursoDecrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
            }
        });

        // Event listeners do gerador de palpites
        document.getElementById('gerarEstrategia1').addEventListener('click', gerarEstrategia1);
        document.getElementById('gerarEstrategia2').addEventListener('click', gerarEstrategia2);
        document.getElementById('gerarEstrategia3').addEventListener('click', gerarEstrategia3);
        
        document.getElementById('limparHistorico').addEventListener('click', () => {
            historicoPalpitesData = [];
            atualizarHistoricoPalpites();
        });

        // Event listeners do modal
        document.getElementById('comoFuncionaBtn').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.remove('hidden');
        });
        
        document.getElementById('fecharModal').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.add('hidden');
        });
        
        // Fechar modal clicando fora
        document.getElementById('modalComoFunciona').addEventListener('click', (e) => {
            if (e.target.id === 'modalComoFunciona') {
                document.getElementById('modalComoFunciona').classList.add('hidden');
            }
        });

        // Event listener para toggle da tabela
        document.getElementById('toggleTabelaBtn').addEventListener('click', () => {
            const resultados = document.getElementById('resultados');
            const toggleBtn = document.getElementById('toggleTabelaBtn');
            
            if (resultados.classList.contains('hidden')) {
                resultados.classList.remove('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Ocultar Tabela de Resultados';
                toggleBtn.className = 'bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            } else {
                resultados.classList.add('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Mostrar Tabela de Resultados';
                toggleBtn.className = 'bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            }
        });

        // üöÄ CARREGAR AUTOMATICAMENTE AO ABRIR A APP
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ APP INICIADA: Carregando dados da API oficial da Caixa...');
            await carregarTodosOsConcursosDaCaixa();
        });
    </script>
</body>
</html>